name: Test

on:
  push

jobs:
  build:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v1
    - name: Set up Python
      uses: actions/setup-python@v1
      with:
        python-version: 3.9
    - name: Make output folder
      run: mkdir output
    - name: Clone master branch
      run: git clone "https://github.com/BelyaevAlex/final-task.git" ./output
    - name: CD
      run: 
        cd output
        cd final-task
    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install poetry
        pip install pytest
        pip install click
        pip install joblib
        pip install sklearn
        pip install pandas
        pip install numpy
        poetry env use python3.9
        poetry add click
        poetry add joblib
        poetry add sklearn
        poetry add pandas
        poetry add numpy
        poetry install --no-dev
        poetry run pytest
